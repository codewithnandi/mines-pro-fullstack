<!doctype html><html><head><meta charset="utf-8"><title>Game - Mines Pro</title></head><body style="font-family:Arial; background:#071021; color:#fff; text-align:center; padding:20px;"><h1>Mines Pro</h1><p>Balance: â‚¹<span id="balance">0</span></p><p>Bet: <input id="bet" type="number" value="10" min="1"></p><p>Mines: <input id="mines" type="number" value="3" min="1" max="24"></p><button onclick="newGame()">Start</button> <button onclick="cashout()" id="cashout" disabled>Cashout</button><p id="status"></p><div id="grid" style="display:grid; grid-template-columns:repeat(5,60px); gap:8px; justify-content:center; margin-top:20px;"></div><h3>History</h3><ul id="history"></ul><script>const API_BASE=''; let token=localStorage.getItem('token'); let user_id=localStorage.getItem('user_id'); let balance=Number(localStorage.getItem('balance')||1000); document.getElementById('balance').innerText=balance; let gridSize=25, mines=3, bet=10, minePositions=[], revealed=new Set(), safeCount=0, clientSeed=''; function newGame(){bet=Number(document.getElementById('bet').value); mines=Number(document.getElementById('mines').value); if(bet>balance){alert('Insufficient balance'); return;} clientSeed=Math.random().toString(36).slice(2); fetch(API_BASE+'/fair/hash').then(r=>r.json()).then(h=>{ fetch(API_BASE+'/fair/play',{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+token},body:JSON.stringify({client_seed:clientSeed,mines:mines,bet:bet})}).then(r=>r.json()).then(data=>{ minePositions=data.mine_positions||[]; const grid=document.getElementById('grid'); grid.innerHTML=''; revealed.clear(); safeCount=0; for(let i=0;i<gridSize;i++){ let cell=document.createElement('div'); cell.style.width='60px'; cell.style.height='60px'; cell.style.background='#0b2540'; cell.style.borderRadius='6px'; cell.style.display='flex'; cell.style.alignItems='center'; cell.style.justifyContent='center'; cell.style.cursor='pointer'; cell.dataset.i=i; cell.onclick=()=>reveal(i,cell); grid.appendChild(cell);} document.getElementById('status').innerText='Game started (server hash: '+h.server_hash.slice(0,10)+'...)'; document.getElementById('cashout').disabled=false; }) }) } function reveal(i,cell){ if(revealed.has(i)) return; revealed.add(i); if(minePositions.includes(i)){ cell.innerText='ðŸ’£'; cell.style.background='#8b0000'; document.getElementById('status').innerText='You hit a mine!'; recordGame('loss',0); } else { cell.innerText='âœ…'; cell.style.background='#006400'; safeCount++; document.getElementById('status').innerText='Safe!'; }} function cashout(){ if(safeCount==0) return; let profit=Math.floor(bet + safeCount*0.2*bet); document.getElementById('status').innerText='Cashed out â‚¹'+profit; recordGame('win', profit);} function recordGame(result, profit){ fetch(API_BASE+'/game/record',{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+token},body:JSON.stringify({bet:bet,mines:mines,client_seed:clientSeed,server_seed:'',result:result,profit:profit})}).then(r=>r.json()).then(d=>{ if(d.new_balance!==undefined){ balance=d.new_balance; localStorage.setItem('balance', balance); document.getElementById('balance').innerText=balance; loadHistory(); } else alert(d.error||'err'); }) } function loadHistory(){ fetch(API_BASE+'/history',{headers:{'Authorization':'Bearer '+token}}).then(r=>r.json()).then(d=>{ const list=document.getElementById('history'); list.innerHTML=''; d.forEach(row=>{ let li=document.createElement('li'); li.innerText=row.timestamp+' | bet:'+row.bet+' | result:'+row.result+' | profit:'+row.profit; list.appendChild(li); }) }) } loadHistory();</script></body></html>